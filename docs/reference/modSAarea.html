<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Small area module - Generate small area tree estimates. — modSAarea • FIESTA</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Small area module - Generate small area tree estimates. — modSAarea"><meta property="og:description" content="Generates small area estimates by domain and/or tree domain (and estimation
unit)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FIESTA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/FIESTA_manual_mod_est.html">`FIESTA` Manual - Module Estimates</a>
    </li>
    <li>
      <a href="../articles/FIESTA_manual_mod_pop.html">`FIESTA` Manual - Population Data</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_DB.html">FIESTA - Database Tools</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_GB.html">FIESTA - Green-book Estimators</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_MA.html">FIESTA - Model-Assisted Estimators</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_PB.html">FIESTA - Photo-Based Module</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_SA.html">FIESTA - Small Area Estimators</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_dat.html">FIESTA - Data Tools</a>
    </li>
    <li>
      <a href="../articles/FIESTA_tutorial_sp.html">FIESTA - Spatial Tools</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Small area module - Generate small area tree estimates.</h1>
    
    <div class="hidden name"><code>modSAarea.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates small area estimates by domain and/or tree domain (and estimation
unit).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">modSAarea</span><span class="op">(</span>
  SApopdatlst <span class="op">=</span> <span class="cn">NULL</span>,
  prednames <span class="op">=</span> <span class="cn">NULL</span>,
  SApackage <span class="op">=</span> <span class="st">"JoSAE"</span>,
  SAmethod <span class="op">=</span> <span class="st">"area"</span>,
  estseed <span class="op">=</span> <span class="st">"none"</span>,
  largebnd.unique <span class="op">=</span> <span class="cn">NULL</span>,
  landarea <span class="op">=</span> <span class="st">"FOREST"</span>,
  pcfilter <span class="op">=</span> <span class="cn">NULL</span>,
  rowvar <span class="op">=</span> <span class="cn">NULL</span>,
  modelselect <span class="op">=</span> <span class="cn">FALSE</span>,
  prior <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span>,
  na.fill <span class="op">=</span> <span class="st">"NONE"</span>,
  savedata <span class="op">=</span> <span class="cn">FALSE</span>,
  savesteps <span class="op">=</span> <span class="cn">FALSE</span>,
  multest <span class="op">=</span> <span class="cn">FALSE</span>,
  addSAdomsdf <span class="op">=</span> <span class="cn">TRUE</span>,
  SAdomvars <span class="op">=</span> <span class="cn">NULL</span>,
  savemultest <span class="op">=</span> <span class="cn">FALSE</span>,
  returntitle <span class="op">=</span> <span class="cn">FALSE</span>,
  table_opts <span class="op">=</span> <span class="cn">NULL</span>,
  title_opts <span class="op">=</span> <span class="cn">NULL</span>,
  savedata_opts <span class="op">=</span> <span class="cn">NULL</span>,
  multest_opts <span class="op">=</span> <span class="cn">NULL</span>,
  save4testing <span class="op">=</span> <span class="cn">FALSE</span>,
  gui <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>SApopdatlst</dt>
<dd><p>List. List of population data objects returned from
modSApop().</p></dd>
<dt>prednames</dt>
<dd><p>String vector. Name(s) of predictor variables to use in
model.</p></dd>
<dt>SApackage</dt>
<dd><p>String. Small area package to use ('JoSAE', 'sae', 'hbsae')</p></dd>
<dt>SAmethod</dt>
<dd><p>String. Small area method to use ('unit', 'area')</p></dd>
<dt>estseed</dt>
<dd><p>String. Use seedling data only or add to tree data. Seedling
estimates are only for counts (estvar='TPA_UNADJ')-('none', 'only', 'add').</p></dd>
<dt>largebnd.unique</dt>
<dd><p>String. Name of the large boundary unique identifer
to define plots within a model extent. If NULL, all plots are used for model
extent.</p></dd>
<dt>landarea</dt>
<dd><p>String. The sample area filter for estimates ('ALL',
'FOREST', 'TIMBERLAND').  If landarea=FOREST, filtered to COND_STATUS_CD =
1; If landarea=TIMBERLAND, filtered to SITECLCD in(1:6) and RESERVCD = 0.</p></dd>
<dt>pcfilter</dt>
<dd><p>String. A filter for plot or cond attributes (including
pltassgn).  Must be R logical syntax.</p></dd>
<dt>rowvar</dt>
<dd><p>String. Name of the row domain variable in cond or tree. If
only one domain, rowvar = domain variable. If more than one domain, include
colvar. If no domain, rowvar = NULL.</p></dd>
<dt>modelselect</dt>
<dd><p>Logical. If TRUE, selects useful predictors using
mase:ElasticNet.</p></dd>
<dt>prior</dt>
<dd><p>Function. A prior function to use for hbsae models.</p></dd>
<dt>na.fill</dt>
<dd><p>String. An estimate to fill in for NA values (i.e., when 
model is unstable or no predictors are selected). Choose from the following 
list that does not include SApackage used ('NONE', 'DIR', 'JoSAE', 'sae', 
'hbsae'). DIR is suggested value for no NA values.</p></dd>
<dt>savedata</dt>
<dd><p>Logical. If TRUE, saves table(s) to outfolder.</p></dd>
<dt>savesteps</dt>
<dd><p>Logical. Saves graphs of predictors and response with
labels whether selected or not for both area- and unit-level models.</p></dd>
<dt>multest</dt>
<dd><p>Logical. If TRUE, returns a data frame of SA estimates using
both unit-level and area-level estimates.</p></dd>
<dt>addSAdomsdf</dt>
<dd><p>Logical. If TRUE, sppends SAdomdf to unit.multest table
for output.</p></dd>
<dt>SAdomvars</dt>
<dd><p>String vector. List of attributes from SAdoms to include in
multest output.</p></dd>
<dt>savemultest</dt>
<dd><p>Logical. If TRUE, save table with area- and unit-level
estimates.</p></dd>
<dt>returntitle</dt>
<dd><p>Logical. If TRUE, returns title(s) of the estimation
table(s).</p></dd>
<dt>table_opts</dt>
<dd><p>List. See help(table_options()) for a list of
options.</p></dd>
<dt>title_opts</dt>
<dd><p>List. See help(title_options()) for a list of options.</p></dd>
<dt>savedata_opts</dt>
<dd><p>List. See help(savedata_options()) for a list
of options. Only used when savedata = TRUE.</p></dd>
<dt>multest_opts</dt>
<dd><p>List. See help(multest_options()) for a list of options.
Only used when multest = TRUE.</p></dd>
<dt>save4testing</dt>
<dd><p>Logical. If TRUE, saves intermediate steps as R objects
to outfolder for testing (pdomdat, dunitlut).</p></dd>
<dt>gui</dt>
<dd><p>Logical. If gui, user is prompted for parameters.</p></dd>
<dt>...</dt>
<dd><p>Parameters for modSApop if SApopdat is NULL.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <dl><dt>est</dt>
<dd><p>Data frame. Tree estimates and percent sampling error by
domain. Estimates are based on the SApackage and SAmethod parameters defined.</p></dd>
<dt>titlelst</dt>
<dd><p>List. List of titles used for table output.</p></dd>
<dt>raw</dt>
<dd><p>List of raw data. If rawdata=TRUE, a list including raw data
components used for calculating estimate.</p></dd>
<dt>dunit.multest</dt>
<dd><p>Data frame. Table comparing different estimation 
strategies for SAE.</p></dd>
</dl><p>Raw data</p>
<dl><dt>domdat</dt>
<dd><p>Data frame. Domain-level data used for estimation.</p></dd>
<dt>dunit.totest</dt>
<dd><p>String. Table of estimates, including more details.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>If variables are NULL, then it will prompt user to input variables.</p>
<p>Necessary variables:<br></p><table class="table table"><tr><td></td><td><b>Data</b></td><td><b>Variable</b></td><td><b>Description</b></td></tr><tr><td></td><td>tree</td><td>tuniqueid</td><td>Unique identifier for each plot, to link to pltstrat (e.g., PLT_CN).</td></tr><tr><td></td><td></td><td>CONDID</td><td>Unique identifier of each condition on plot, to link to
cond.  Set CONDID=1, if only 1 condition per plot.</td></tr><tr><td></td><td></td><td>TPA_UNADJ</td><td>Number of trees per acre each sample tree represents (ex. DESIGNCD=1:
TPA_UNADJ=6.018046 for trees on subplot; 74.965282 for trees on
microplot).</td></tr><tr><td></td><td>cond</td><td>cuniqueid</td><td>Unique identifier for each
plot, to link to pltstrat (ex. PLT_CN).</td></tr><tr><td></td><td></td><td>CONDID</td><td>Unique
identfier of each condition on plot.  Set CONDID=1, if only 1 condition per
plot.</td></tr><tr><td></td><td></td><td>CONDPROP_UNADJ</td><td>Unadjusted proportion of condition on
each plot.  Set CONDPROP_UNADJ=1, if only 1 condition per plot.</td></tr><tr><td></td><td></td><td>COND_STATUS_CD</td><td>Status of each forested condition on plot (i.e.
accessible forest, nonforest, water, etc.)</td></tr><tr><td></td><td></td><td>NF_COND_STATUS_CD</td><td>If ACI=TRUE. Status of each nonforest condition on plot (i.e.
accessible nonforest, nonsampled nonforest)</td></tr><tr><td></td><td></td><td>SITECLCD</td><td>If
landarea=TIMBERLAND. Measure of site productivity.</td></tr><tr><td></td><td></td><td>RESERVCD</td><td>If landarea=TIMBERLAND. Reserved status.</td></tr><tr><td></td><td></td><td>SUBPROP_UNADJ</td><td>Unadjusted proportion of subplot conditions on each plot.  Set
SUBPROP_UNADJ=1, if only 1 condition per subplot.</td></tr><tr><td></td><td></td><td>MICRPROP_UNADJ</td><td>If microplot tree attributes. Unadjusted proportion of
microplot conditions on each plot. Set MICRPROP_UNADJ=1, if only 1 condition
per microplot.</td></tr><tr><td></td><td></td><td>MACRPROP_UNADJ</td><td>If macroplot tree
attributes. Unadjusted proportion of macroplot conditions on each plot. Set
MACRPROP_UNADJ=1, if only 1 condition per macroplot.</td></tr><tr><td></td><td>pltassign</td><td>puniqueid</td><td>Unique identifier for each plot, to link to cond (ex. CN).</td></tr><tr><td></td><td></td><td>STATECD</td><td>Identifies state each plot is located in.</td></tr><tr><td></td><td></td><td>INVYR</td><td>Identifies inventory year of each plot.</td></tr><tr><td></td><td></td><td>PLOT_STATUS_CD</td><td>Status of each plot (i.e. sampled, nonsampled).  If not
included, all plots are assumed as sampled.</td></tr></table><p>Reference names are available for the following variables: <br> ADFORCD,
AGENTCD, CCLCD, DECAYCD, DSTRBCD, KINDCD, OWNCD, OWNGRPCD, FORTYPCD,
FLDTYPCD, FORTYPCDCALC, TYPGRPCD, FORINDCD, RESERVCD, LANDCLCD, STDSZCD,
FLDSZCD, PHYSCLCD, MIST_CL_CD, PLOT_STATUS_CD, STATECD, TREECLCD, TRTCD,
SPCD, SPGRPCD</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>ADJUSTMENT FACTOR:<br> The adjustment factor is necessary to account for
nonsampled conditions.  For model-based estimation, we calculate adjustment
factors by plot.</p>
<p>It is calculated by dividing 1 / summed condition proportions by plot. An
adjustment factor is determined for each tree based on the size of the plot
it was measured on. This is identified using TPA_UNADJ as follows:</p>
<table class="table table"><tr><td></td><td><b>PLOT SIZE</b></td><td><b>TPA_UNADJ</b></td></tr><tr><td></td><td>SUBPLOT</td><td>6.018046</td></tr><tr><td></td><td>MICROPLOT</td><td>74.965282</td></tr><tr><td></td><td>MACROPLOT</td><td>0.999188</td></tr></table><p>If ACI=FALSE, only nonsampled forest conditions are accounted for in the
adjustment factor. <br> If ACI=TRUE, the nonsampled nonforest conditions are
removed as well and accounted for in adjustment factor.  This is if you are
interested in estimates for all lands or nonforest lands in the
All-Condition-Inventory.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Breidenbach, J. 2018. JoSAE: Unit-Level and Area-Level Small
Area Estimation.  R package version 0.3.0.
https://CRAN.R-project.org/package=JoSAE.</p>
<p>Molina I, Marhuenda Y. 2015. sae: An R Package for Small Area Estimation.
The R Journal 7(1), 81-98.
https://journal.r-project.org/archive/2015/RJ-2015-007/RJ-2015-007.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Tracey S. Frescino, Paul L. Patterson, Elizabeth A. Freeman</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># Set up population dataset (see ?modSApop() for more information)</span></span>
<span class="r-in"><span class="va">SApopdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="modSApop.html">modSApop</a></span><span class="op">(</span>popTabs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tree <span class="op">=</span> <span class="fu">FIESTA</span><span class="fu">::</span><span class="va"><a href="WYtree.html">WYtree</a></span>,</span>
<span class="r-in">                                    cond <span class="op">=</span> <span class="fu">FIESTA</span><span class="fu">::</span><span class="va"><a href="WYcond.html">WYcond</a></span><span class="op">)</span>,</span>
<span class="r-in">                     pltassgn <span class="op">=</span> <span class="fu">FIESTA</span><span class="fu">::</span><span class="va"><a href="WYpltassgn.html">WYpltassgn</a></span>,</span>
<span class="r-in">                     pltassgnid <span class="op">=</span> <span class="st">"CN"</span>,</span>
<span class="r-in">                     dunitarea <span class="op">=</span> <span class="fu">FIESTA</span><span class="fu">::</span><span class="va"><a href="WYunitarea.html">WYunitarea</a></span>,</span>
<span class="r-in">                     dunitvar <span class="op">=</span> <span class="st">"ESTN_UNIT"</span>,</span>
<span class="r-in">                     dunitzonal <span class="op">=</span> <span class="fu">FIESTA</span><span class="fu">::</span><span class="va"><a href="WYunitzonal.html">WYunitzonal</a></span>,</span>
<span class="r-in">                     prednames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dem"</span>, <span class="st">"tcc"</span>, <span class="st">"tpi"</span>, <span class="st">"tnt"</span><span class="op">)</span>,</span>
<span class="r-in">                     predfac <span class="op">=</span> <span class="st">"tnt"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Fit a unit level EBLUP with `JoSAE`</span></span>
<span class="r-in"><span class="fu">modSAarea</span><span class="op">(</span>SApopdatlst <span class="op">=</span> <span class="va">SApopdat</span>,</span>
<span class="r-in">          SApackage <span class="op">=</span> <span class="st">"JoSAE"</span>,</span>
<span class="r-in">          SAmethod <span class="op">=</span> <span class="st">"unit"</span><span class="op">)</span> </span>
<span class="r-in">          </span>
<span class="r-in"><span class="co"># Fit an area level Fay-Herriot hierarchical Bayesian model with `hbsae`</span></span>
<span class="r-in"><span class="fu">modSAarea</span><span class="op">(</span>SApopdatlst <span class="op">=</span> <span class="va">SApopdat</span>,</span>
<span class="r-in">          SApackage <span class="op">=</span> <span class="st">"hbsae"</span>,</span>
<span class="r-in">          SAmethod <span class="op">=</span> <span class="st">"area"</span><span class="op">)</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Fit an area level Fay-Herriot EBLUP with `sae`, while using Elastic Net</span></span>
<span class="r-in"><span class="co"># variable selection</span></span>
<span class="r-in"><span class="fu">modSAarea</span><span class="op">(</span>SApopdatlst <span class="op">=</span> <span class="va">SApopdat</span>,</span>
<span class="r-in">          SApackage <span class="op">=</span> <span class="st">"sae"</span>,</span>
<span class="r-in">          SAmethod <span class="op">=</span> <span class="st">"area"</span>,</span>
<span class="r-in">          modelselect <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tracey Frescino, Gretchen Moisen, Paul Patterson, Chris Toney, Grayson White.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

