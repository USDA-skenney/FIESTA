---
output:
  word_document:
    reference_docx: template.docx
params:
  rawfolder: ""
  AOInm: ""
  title.ref: NULL
  year: NULL
  GBpopdat: NULL
  photofn: ""
---


```{r echo=FALSE, warning=FALSE, message=FALSE}
library(FIESTA)

rawfolder <- "C:/Users/tfrescino/Documents/Fishlake/rawdata"
AOInm <- "Fishlake"
title.ref <- NULL

rawfolder <- params$rawfolder
AOInm <- params$AOInm
title.ref <- params$title.ref
outfolder <- params$outfolder
photofn <- params$photofn

if (is.null(rawfolder)) stop()
if (is.null(AOInm)) stop()

if (is.null(title.ref)) title.ref <- AOInm
if (is.null(outfolder)) outfolder <- rawfolder
figNum <- 0


```



```{r echo=FALSE, warning=FALSE, message=FALSE}

rowestfn <- list.files(rawfolder, pattern=glob2rx("01*unit.rowest*csv"))
grpestfn <- list.files(rawfolder, pattern=glob2rx("01*unit.grpest*csv"))
xtabfn <- list.files(dirname(rawfolder), glob2rx("01*csv"))

rowest <- fread(file.path(rawfolder, rowestfn))
grpest <- fread(file.path(rawfolder, grpestfn))
xtab <- fread(file.path(dirname(rawfolder), xtabfn))

title.rowvar <- "Land class"
title.colvar <- "Reserved status"
totarea <- unique(rowest$ACRES_GIS)
area.for <- rowest[rowest[[title.rowvar]] == "Forest land", "est"]
area.nf <- rowest[rowest[[title.rowvar]] == "Nonforest land", "est"]
area.water <- sum(rowest[rowest[[title.rowvar]] %in% c("Noncensus water", "Nonforest land"), "est"])
est <- rowest[, c(title.rowvar, "est", "pse"), with=FALSE]

title1 <- paste0("Area by land class, ", title.ref)
title2 <- paste0("Area by land class and reserved status, ", title.ref)



```


---
title: "Report summary for `r AOInm`"
---


&nbsp;
&nbsp;

__Date:__ `r format(Sys.time(), "%B %d, %Y")`


&nbsp;
&nbsp;

`r figNum=0`

############### 
![](report_image.png)

``` {r picture,include=FALSE}
figNum = figNum+1
figCap = paste0("Figure ",figNum,": Photo from", AOInm)
```
########## `r figCap`


&nbsp;
&nbsp;


The area of `r params$AOInm` is `r format(round(totarea), big.mark=",")` acres with `r round(area.for/totarea * 100)` percent of the area classified as forest land, `r round(area.nf/totarea * 100)` percent classified as nonforest land, and `r round(area.water/totarea * 100)` percent as water (Fig. 1).


&nbsp;
&nbsp;
&nbsp;
&nbsp;


```{r echo=FALSE, warning=FALSE, message=FALSE}

## Create prettier table
knitr::kable(xtab, 'simple', align=c('l', 'r', 'r', 'r'), 
             caption=paste("Table 1:", title2))


```


&nbsp;
&nbsp;



```{r echo=FALSE, warning=FALSE, message=FALSE, fig.cap=paste("Fig. 1.", title1)}

datBarplot(x=rowest, xvar=names(rowest)[2], yvar="est", errbars=TRUE, 
           sevar="est.se", x.order=NULL, las.xnames=2, ylabel="Area - Acres", 
           col=terrain.colors(nrow(rowest)), ylim=NULL, toplabelvar="NBRPLT.gt0")

#datBarStacked(x=grpest, main.attribute=title.rowvar, sub.attribute=title.colvar, 
#              response="est", horiz=FALSE,
#              main.order=unique(grpest[[title.rowvar]]), sub.order=unique(grpest[[title.colvar]]))


```


&nbsp;
&nbsp;

